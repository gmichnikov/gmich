{% extends "base.html" %}

{% block title %}Passport Photo Tool{% endblock %}

{% block styles %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css">
<link rel="stylesheet" href="{{ url_for('passport_photo.static', filename='passport_photo/style.css') }}">
{% endblock %}

{% block content %}
<div class="passport-photo-container">
    <div class="passport-photo-card">
        <header class="passport-photo-header">
            <h1>Passport Photo Tool</h1>
            <p>Create a printable 4x6" sheet with two 2x2" passport photos.</p>
        </header>

        <!-- Phase 1: Upload Section -->
        <div id="passport-photo-upload-section" class="passport-photo-upload-section">
            <span class="passport-photo-upload-icon">ðŸ“·</span>
            <h2>Upload Your Photo</h2>
            <p>Drag and drop or click to select a JPEG or PNG image.</p>
            <input type="file" id="passport-photo-file-input" class="passport-photo-hidden" accept="image/jpeg,image/png">
            <button class="passport-photo-btn-primary">Select Photo</button>
        </div>

        <!-- Phase 2: Editor Section -->
        <div id="passport-photo-editor-section" class="passport-photo-editor-section">
            <div class="passport-photo-cropper-container">
                <img id="passport-photo-image">
            </div>
            
        <div class="passport-photo-controls">
            <button id="passport-photo-reset-btn" class="passport-photo-btn-secondary">Start Over</button>
            <button id="passport-photo-whiten-btn" class="passport-photo-btn-secondary">Whiten Background (AI)</button>
            <button id="passport-photo-undo-btn" class="passport-photo-btn-secondary passport-photo-hidden">Restore Original</button>
            <button id="passport-photo-generate-btn" class="passport-photo-btn-primary">Generate Print Sheet</button>
        </div>

            <div class="passport-photo-instructions" style="margin-top: 1.5rem; text-align: center; color: #666; font-size: 0.9rem;">
            <p><strong>Instructions:</strong> Align your face with the blue guide <strong>inside</strong> the cropping square. Move the square or zoom the image until your head fits the guide.</p>
        </div>

        <!-- Adjustments Section -->
        <div class="passport-photo-adjustments">
            <div class="passport-photo-adjustment-group">
                <label for="passport-photo-brightness">Brightness</label>
                <input type="range" id="passport-photo-brightness" min="50" max="150" value="100">
                <span id="passport-photo-brightness-value">100%</span>
            </div>
            <div class="passport-photo-adjustment-group">
                <label for="passport-photo-contrast">Contrast</label>
                <input type="range" id="passport-photo-contrast" min="50" max="150" value="100">
                <span id="passport-photo-contrast-value">100%</span>
            </div>
        </div>

        <!-- Phase 3: Preview Section -->
        <div id="passport-photo-preview-section" class="passport-photo-preview-section">
            <h2>Your Print Sheet (4x6")</h2>
            <p>Ready to print at CVS, Walgreens, or home.</p>
            
            <div class="passport-photo-preview-canvas-container">
                <canvas id="passport-photo-print-canvas"></canvas>
            </div>
            
            <div class="passport-photo-controls">
                <button id="passport-photo-download-btn" class="passport-photo-btn-primary">Download Print Sheet (JPG)</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
<!-- MediaPipe Selfie Segmentation -->
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/selfie_segmentation.js" crossorigin="anonymous"></script>
<script src="{{ url_for('passport_photo.static', filename='passport_photo/script.js') }}"></script>
{% endblock %}
