{% extends 'base.html' %}

{% block title %}Family Members - Better Signups{% endblock %}

{% block content %}

<div class="auth-page-container">
    <div class="auth-card">
        <div class="auth-header">
            <h1 class="auth-title">Family Members</h1>
            <p class="auth-subtitle">Manage family members who can sign up for events and items</p>
        </div>

        <div style="margin-bottom: 2rem;">
            <h2 style="font-size: 1.25rem; margin-bottom: 1rem;">Add Family Member</h2>
            <form method="post" action="{{ url_for('better_signups.add_family_member') }}" class="auth-form">
                {{ form.hidden_tag() }}
                
                <div class="auth-form-group">
                    {{ form.display_name.label(class="auth-label") }}
                    {{ form.display_name(class="auth-input", placeholder="John Doe") }}
                    {% if form.display_name.errors %}
                        <div class="auth-error-messages">
                            {% for error in form.display_name.errors %}
                                <span class="auth-error">{{ error }}</span>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <div class="auth-form-group">
                    {{ form.submit(class="auth-submit-btn") }}
                </div>
            </form>
        </div>

        <div style="border-top: 1px solid #e0e0e0; padding-top: 2rem;">
            <h2 style="font-size: 1.25rem; margin-bottom: 1rem;">Your Family Members</h2>
            
            {% if family_members %}
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    {% for member in family_members %}
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; background-color: #f9f9f9; border-radius: 8px;">
                            <div>
                                <strong>{{ member.display_name }}</strong>
                                {% if member.is_self %}
                                    <span style="color: #666; font-size: 0.875rem; margin-left: 0.5rem;">(You)</span>
                                {% endif %}
                                <div style="color: #666; font-size: 0.875rem; margin-top: 0.25rem;">
                                    Added {{ member.created_at.strftime('%B %d, %Y') }}
                                </div>
                            </div>
                            {% if not member.is_self %}
                                <form method="post" action="{{ url_for('better_signups.delete_family_member', member_id=member.id) }}" 
                                      onsubmit="return confirm('Are you sure you want to delete {{ member.display_name }}? This cannot be undone.');">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                                    <button type="submit" class="auth-submit-btn" style="background-color: #dc3545; padding: 0.5rem 1rem; font-size: 0.875rem;">
                                        Delete
                                    </button>
                                </form>
                            {% else %}
                                <span style="color: #999; font-size: 0.875rem;">Cannot delete</span>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p style="color: #666;">No family members yet. Add one above!</p>
            {% endif %}
        </div>

        <div class="auth-footer" style="margin-top: 2rem;">
            <p class="auth-footer-text"><a href="{{ url_for('better_signups.index') }}" class="auth-link">‚Üê Back to Better Signups</a></p>
        </div>
    </div>
</div>

{% endblock %}

